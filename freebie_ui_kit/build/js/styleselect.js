!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.returnExports=t()}(this,function(){var e=document.querySelector.bind(document),t=document.querySelectorAll.bind(document),a={SPACE:32,UP:38,DOWN:40,ENTER:13};NodeList.prototype.forEach||(NodeList.prototype.forEach=Array.prototype.forEach),HTMLCollection.prototype.forEach||(HTMLCollection.prototype.forEach=Array.prototype.forEach),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.oMatchesSelector);var n=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var a=document.createEvent("CustomEvent");return a.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),a};if(n.prototype=window.Event.prototype,window.CustomEvent=n,!(document.documentElement.dataset||Object.getOwnPropertyDescriptor(Element.prototype,"dataset")&&Object.getOwnPropertyDescriptor(Element.prototype,"dataset").get)){var o={enumerable:!0,get:function(){"use strict";var e,t,a,n,o,r,s=this,i=this.attributes,c=i.length,d=function(e){return e.charAt(1).toUpperCase()},l=function(){return this},u=function(e,t){return"undefined"!=typeof t?this.setAttribute(e,t):this.removeAttribute(e)};try{({}).__defineGetter__("test",function(){}),t={}}catch(p){t=document.createElement("div")}for(e=0;e<c;e++)if(r=i[e],r&&r.name&&/^data-\w[\w\-]*$/.test(r.name)){a=r.value,n=r.name,o=n.substr(5).replace(/-./g,d);try{Object.defineProperty(t,o,{enumerable:this.enumerable,get:l.bind(a||""),set:u.bind(s,n)})}catch(f){t[o]=a}}return t}};try{Object.defineProperty(Element.prototype,"dataset",o)}catch(r){o.enumerable=!1,Object.defineProperty(Element.prototype,"dataset",o)}}var s=function(e,t,a){var n=e.parentNode;if(a&&e.matches(t))return!0;for(;n&&n.nodeType&&1===n.nodeType;){if(n.matches(t))return!0;n=n.parentNode}return!1},i=function(){return"ss-xxxx-xxxx-xxxx-xxxx-xxxx".replace(/x/g,function(e){var t=16*Math.random()|0,a="x"==e?t:3&t|8;return a.toString(16)})};return function(o){if(!navigator.userAgent.match(/iPad|iPhone|Android/i)){var r,c=e(o),d=c.children,l=c.selectedIndex,u=i(),p='<div class="style-select" aria-hidden="true" data-ss-uuid="'+u+'">',f=d.length-1;c.setAttribute("data-ss-uuid",u),c.setAttribute("aria-hidden","false");var v,h='<div class="ss-dropdown">';d.forEach(function(e,t){var a=e.textContent,n=e.getAttribute("value")||"",o="ss-option";t===l&&(v='<div class="ss-selected-option" tabindex="0" data-value="'+n+'">'+a+"</div>"),e.disabled&&(o+=" disabled"),h+='<div class="'+o+'" data-value="'+n+'">'+a+"</div>"}),h+="</div>",p+=v+=h+="</div>",c.insertAdjacentHTML("afterend",p);var m=e('.style-select[data-ss-uuid="'+u+'"]'),y=m.querySelectorAll(".ss-option"),E=m.querySelector(".ss-selected-option"),b=function(e,t){m.classList.remove("open"),E.textContent=t,E.dataset.value=e,y.forEach(function(t){t.dataset.value===e?t.classList.add("ticked"):t.classList.remove("ticked")}),c.value=e;var a=new n("change");c.dispatchEvent(a)};y.forEach(function(e,t){var a=y.item(t);a.className.match(/\bdisabled\b/)||(a.addEventListener("click",function(e){var t=e.target,a=t.parentNode.parentNode,n=(a.getAttribute("data-ss-uuid"),t.getAttribute("data-value")),o=t.textContent;b(n,o)}),a.dataset.value===c.value&&(r=t,a.classList.add("ticked"),a.classList.add("highlighted")),a.addEventListener("mouseover",function(e){a.parentNode.childNodes.forEach(function(t,a){t===e.target?(t.classList.add("highlighted"),r=a):t.classList.remove("highlighted")})}))});var g=function(e){t(".style-select").forEach(function(t){t!==e&&t.classList.remove("open")})},x=function(e){e.classList.contains("open")||g(e),e.classList.toggle("open")},L=e('.style-select[data-ss-uuid="'+u+'"] .ss-selected-option');L.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),x(e.target.parentNode)}),L.addEventListener("keydown",function(e){var t=e.target.parentNode;switch(e.keyCode){case a.SPACE:x(t);break;case a.DOWN:case a.UP:t.classList.contains("open")?(e.keyCode===a.UP?0!==r&&(r-=1):r<f&&(r+=1),y.forEach(function(e,t){t===r?e.classList.add("highlighted"):e.classList.remove("highlighted")})):x(t),e.preventDefault(),e.stopPropagation();break;case a.ENTER:var n=L.parentNode.querySelectorAll(".ss-option")[r],o=n.dataset.value,s=n.textContent;b(o,s),e.preventDefault(),e.stopPropagation()}}),e("body").addEventListener("click",function(e){s(e.target,".style-select",!0)||g()})}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN0eWxlc2VsZWN0LmpzIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZGVmaW5lIiwiYW1kIiwiZXhwb3J0cyIsIm1vZHVsZSIsInJldHVybkV4cG9ydHMiLCJ0aGlzIiwicXVlcnkiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJiaW5kIiwicXVlcnlBbGwiLCJxdWVyeVNlbGVjdG9yQWxsIiwiS0VZQ09ERVMiLCJTUEFDRSIsIlVQIiwiRE9XTiIsIkVOVEVSIiwiTm9kZUxpc3QiLCJwcm90b3R5cGUiLCJmb3JFYWNoIiwiQXJyYXkiLCJIVE1MQ29sbGVjdGlvbiIsIkVsZW1lbnQiLCJtYXRjaGVzIiwibXNNYXRjaGVzU2VsZWN0b3IiLCJtb3pNYXRjaGVzU2VsZWN0b3IiLCJ3ZWJraXRNYXRjaGVzU2VsZWN0b3IiLCJvTWF0Y2hlc1NlbGVjdG9yIiwiQ3VzdG9tRXZlbnQiLCJldmVudE5hbWUiLCJwYXJhbXMiLCJidWJibGVzIiwiY2FuY2VsYWJsZSIsImRldGFpbCIsInVuZGVmaW5lZCIsImV2ZW50IiwiY3JlYXRlRXZlbnQiLCJpbml0Q3VzdG9tRXZlbnQiLCJ3aW5kb3ciLCJFdmVudCIsImRvY3VtZW50RWxlbWVudCIsImRhdGFzZXQiLCJPYmplY3QiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJnZXQiLCJwcm9wRGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJpIiwiSFRNTDVfRE9NU3RyaW5nTWFwIiwiYXR0clZhbCIsImF0dHJOYW1lIiwicHJvcE5hbWUiLCJhdHRyaWJ1dGUiLCJ0aGF0IiwiYXR0cmlidXRlcyIsImF0dHNMZW5ndGgiLCJsZW5ndGgiLCJ0b1VwcGVyQ2FzZSIsIm4wIiwiY2hhckF0IiwiZ2V0dGVyIiwic2V0dGVyIiwidmFsdWUiLCJzZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJfX2RlZmluZUdldHRlcl9fIiwiZTEiLCJjcmVhdGVFbGVtZW50IiwibmFtZSIsInRlc3QiLCJzdWJzdHIiLCJyZXBsYWNlIiwiZGVmaW5lUHJvcGVydHkiLCJzZXQiLCJlMiIsImUiLCJpc0FuY2VzdG9yT2YiLCJlbGVtZW50Iiwic2VsZWN0b3IiLCJpbmNsdWRlU2VsZiIsInBhcmVudCIsInBhcmVudE5vZGUiLCJub2RlVHlwZSIsIm1ha2VVVUlEIiwiYyIsInIiLCJNYXRoIiwicmFuZG9tIiwidiIsInRvU3RyaW5nIiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwibWF0Y2giLCJoaWdobGlnaHRlZE9wdGlvbkluZGV4IiwicmVhbFNlbGVjdCIsInJlYWxPcHRpb25zIiwiY2hpbGRyZW4iLCJzZWxlY3RlZEluZGV4IiwidXVpZCIsInN0eWxlU2VsZWN0SFRNTCIsImhpZ2hsaWdodGVkT3B0aW9uSW5kZXhNYXgiLCJzZWxlY3RlZE9wdGlvbkhUTUwiLCJvcHRpb25zSFRNTCIsInJlYWxPcHRpb24iLCJpbmRleCIsInRleHQiLCJ0ZXh0Q29udGVudCIsImdldEF0dHJpYnV0ZSIsImNzc0NsYXNzIiwiZGlzYWJsZWQiLCJpbnNlcnRBZGphY2VudEhUTUwiLCJzdHlsZWRTZWxlY3QiLCJzdHlsZVNlbGVjdE9wdGlvbnMiLCJzZWxlY3RlZE9wdGlvbiIsImNoYW5nZVJlYWxTZWxlY3RCb3giLCJuZXdWYWx1ZSIsIm5ld0xhYmVsIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwic3R5bGVTZWxlY3RPcHRpb24iLCJhZGQiLCJjaGFuZ2VFdmVudCIsImRpc3BhdGNoRXZlbnQiLCJ1bnVzZWQiLCJpdGVtIiwiY2xhc3NOYW1lIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2IiwidGFyZ2V0Iiwic3R5bGVkU2VsZWN0Qm94IiwiY2hpbGROb2RlcyIsInNpYmxpbmciLCJjbG9zZUFsbFN0eWxlU2VsZWN0cyIsImV4Y2VwdGlvbiIsInN0eWxlU2VsZWN0RWwiLCJ0b2dnbGVTdHlsZWRTZWxlY3QiLCJjb250YWlucyIsInRvZ2dsZSIsInN0eWxlZFNlbGVjdGVkT3B0aW9uIiwicHJldmVudERlZmF1bHQiLCJzdG9wUHJvcGFnYXRpb24iLCJrZXlD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IjpbIihmdW5jdGlvbiAocm9vdCwgZmFjdG9yeSkge1xyXG4gICAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xyXG4gICAgICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cclxuICAgICAgICBkZWZpbmUoW10sIGZhY3RvcnkpO1xyXG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAvLyBOb2RlLiBEb2VzIG5vdCB3b3JrIHdpdGggc3RyaWN0IENvbW1vbkpTLCBidXRcclxuICAgICAgICAvLyBvbmx5IENvbW1vbkpTLWxpa2UgZW52aXJvbm1lbnRzIHRoYXQgc3VwcG9ydCBtb2R1bGUuZXhwb3J0cyxcclxuICAgICAgICAvLyBsaWtlIE5vZGUuXHJcbiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEJyb3dzZXIgZ2xvYmFscyAocm9vdCBpcyB3aW5kb3cpXHJcbiAgICAgICAgcm9vdC5yZXR1cm5FeHBvcnRzID0gZmFjdG9yeSgpO1xyXG4gIH1cclxufSh0aGlzLCBmdW5jdGlvbiAoKSB7XHJcbi8vIEVuZCBvZiBVTUQgbW9kdWxlXHJcblxyXG5cdC8vIFF1aWNrIGFsaWFzZXMgYW5kIHBvbHlmaWxscyBpZiBuZWVkZWRcclxuXHR2YXIgcXVlcnkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yLmJpbmQoZG9jdW1lbnQpO1xyXG5cdHZhciBxdWVyeUFsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwuYmluZChkb2N1bWVudCk7XHJcblxyXG5cdHZhciBLRVlDT0RFUyA9IHtcclxuXHRcdFNQQUNFOiAzMixcclxuXHRcdFVQOiAzOCxcclxuXHRcdERPV046IDQwLFxyXG5cdFx0RU5URVI6IDEzXHJcblx0fTtcclxuXHJcblx0aWYgKCAhIE5vZGVMaXN0LnByb3RvdHlwZS5mb3JFYWNoICkge1xyXG5cdFx0Tm9kZUxpc3QucHJvdG90eXBlLmZvckVhY2ggPSBBcnJheS5wcm90b3R5cGUuZm9yRWFjaDtcclxuXHR9XHJcblx0aWYgKCAhIEhUTUxDb2xsZWN0aW9uLnByb3RvdHlwZS5mb3JFYWNoICkge1xyXG5cdFx0SFRNTENvbGxlY3Rpb24ucHJvdG90eXBlLmZvckVhY2ggPSBBcnJheS5wcm90b3R5cGUuZm9yRWFjaDtcclxuXHR9XHJcblx0aWYgKCAhIEVsZW1lbnQucHJvdG90eXBlLm1hdGNoZXMgKSB7XHJcblx0XHQvLyBTZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0VsZW1lbnQubWF0Y2hlc1xyXG5cdFx0RWxlbWVudC5wcm90b3R5cGUubWF0Y2hlcyA9IEVsZW1lbnQucHJvdG90eXBlLm1zTWF0Y2hlc1NlbGVjdG9yIHx8IEVsZW1lbnQucHJvdG90eXBlLm1vek1hdGNoZXNTZWxlY3RvciB8fCBFbGVtZW50LnByb3RvdHlwZS53ZWJraXRNYXRjaGVzU2VsZWN0b3IgfHwgRWxlbWVudC5wcm90b3R5cGUub01hdGNoZXNTZWxlY3RvclxyXG5cdH1cclxuXHJcblx0Ly8gSUUgOS0xMSBDdXN0b21FdmVudCBwb2x5ZmlsbFxyXG5cdC8vIEZyb20gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vZG9jcy9XZWIvQVBJL0N1c3RvbUV2ZW50XHJcblx0dmFyIEN1c3RvbUV2ZW50ID0gZnVuY3Rpb24oIGV2ZW50TmFtZSwgcGFyYW1zICkge1xyXG5cdFx0cGFyYW1zID0gcGFyYW1zIHx8IHsgYnViYmxlczogZmFsc2UsIGNhbmNlbGFibGU6IGZhbHNlLCBkZXRhaWw6IHVuZGVmaW5lZCB9O1xyXG5cdFx0dmFyIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoICdDdXN0b21FdmVudCcgKTtcclxuXHRcdGV2ZW50LmluaXRDdXN0b21FdmVudCggZXZlbnROYW1lLCBwYXJhbXMuYnViYmxlcywgcGFyYW1zLmNhbmNlbGFibGUsIHBhcmFtcy5kZXRhaWwgKTtcclxuXHRcdHJldHVybiBldmVudDtcclxuXHR9O1xyXG5cdEN1c3RvbUV2ZW50LnByb3RvdHlwZSA9IHdpbmRvdy5FdmVudC5wcm90b3R5cGU7XHJcblx0d2luZG93LkN1c3RvbUV2ZW50ID0gQ3VzdG9tRXZlbnQ7XHJcblxyXG5cdC8vIElFMTAgZGF0YXNldCBwb2x5ZmlsbFxyXG5cdC8vIEZyb20gaHR0cHM6Ly9naXN0LmdpdGh1YnVzZXJjb250ZW50LmNvbS9icmV0dHo5LzQwOTM3NjYvcmF3L2JhMzFhMDVlN2NlMjFhZjY3YzZjYWZlZTliM2Y0MzljODZlOTViMDEvaHRtbDUtZGF0YXNldC5qc1xyXG5cdGlmICghZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRhdGFzZXQgJiZcclxuXHRcdFx0IC8vIEZGIGlzIGVtcHR5IHdoaWxlIElFIGdpdmVzIGVtcHR5IG9iamVjdFxyXG5cdFx0XHQoIU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoRWxlbWVudC5wcm90b3R5cGUsICdkYXRhc2V0JykgIHx8XHJcblx0XHRcdCFPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKEVsZW1lbnQucHJvdG90eXBlLCAnZGF0YXNldCcpLmdldClcclxuXHRcdCkge1xyXG5cdFx0dmFyIHByb3BEZXNjcmlwdG9yID0ge1xyXG5cdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxyXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHQndXNlIHN0cmljdCc7XHJcblx0XHRcdFx0dmFyIGksXHJcblx0XHRcdFx0XHR0aGF0ID0gdGhpcyxcclxuXHRcdFx0XHRcdEhUTUw1X0RPTVN0cmluZ01hcCxcclxuXHRcdFx0XHRcdGF0dHJWYWwsIGF0dHJOYW1lLCBwcm9wTmFtZSxcclxuXHRcdFx0XHRcdGF0dHJpYnV0ZSxcclxuXHRcdFx0XHRcdGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXMsXHJcblx0XHRcdFx0XHRhdHRzTGVuZ3RoID0gYXR0cmlidXRlcy5sZW5ndGgsXHJcblx0XHRcdFx0XHR0b1VwcGVyQ2FzZSA9IGZ1bmN0aW9uIChuMCkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gbjAuY2hhckF0KDEpLnRvVXBwZXJDYXNlKCk7XHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0Z2V0dGVyID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gdGhpcztcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRzZXR0ZXIgPSBmdW5jdGlvbiAoYXR0ck5hbWUsIHZhbHVlKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiAodHlwZW9mIHZhbHVlICE9PSAndW5kZWZpbmVkJykgP1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMuc2V0QXR0cmlidXRlKGF0dHJOYW1lLCB2YWx1ZSkgOlxyXG5cdFx0XHRcdFx0XHRcdHRoaXMucmVtb3ZlQXR0cmlidXRlKGF0dHJOYW1lKTtcclxuXHRcdFx0XHRcdH07XHJcblx0XHRcdFx0dHJ5IHsgLy8gU2ltdWxhdGUgRE9NU3RyaW5nTWFwIHcvYWNjZXNzb3Igc3VwcG9ydFxyXG5cdFx0XHRcdFx0Ly8gVGVzdCBzZXR0aW5nIGFjY2Vzc29yIG9uIG5vcm1hbCBvYmplY3RcclxuXHRcdFx0XHRcdCh7fSkuX19kZWZpbmVHZXR0ZXJfXygndGVzdCcsIGZ1bmN0aW9uICgpIHt9KTtcclxuXHRcdFx0XHRcdEhUTUw1X0RPTVN0cmluZ01hcCA9IHt9O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRjYXRjaCAoZTEpIHsgLy8gVXNlIGEgRE9NIG9iamVjdCBmb3IgSUU4XHJcblx0XHRcdFx0XHRIVE1MNV9ET01TdHJpbmdNYXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Zm9yIChpID0gMDsgaSA8IGF0dHNMZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdFx0YXR0cmlidXRlID0gYXR0cmlidXRlc1tpXTtcclxuXHRcdFx0XHRcdC8vIEZpeDogVGhpcyB0ZXN0IHJlYWxseSBzaG91bGQgYWxsb3cgYW55IFhNTCBOYW1lIHdpdGhvdXRcclxuXHRcdFx0XHRcdC8vICAgICAgICAgY29sb25zIChhbmQgbm9uLXVwcGVyY2FzZSBmb3IgWEhUTUwpXHJcblx0XHRcdFx0XHRpZiAoYXR0cmlidXRlICYmIGF0dHJpYnV0ZS5uYW1lICYmXHJcblx0XHRcdFx0XHRcdCgvXmRhdGEtXFx3W1xcd1xcLV0qJC8pLnRlc3QoYXR0cmlidXRlLm5hbWUpKSB7XHJcblx0XHRcdFx0XHRcdGF0dHJWYWwgPSBhdHRyaWJ1dGUudmFsdWU7XHJcblx0XHRcdFx0XHRcdGF0dHJOYW1lID0gYXR0cmlidXRlLm5hbWU7XHJcblx0XHRcdFx0XHRcdC8vIENoYW5nZSB0byBDYW1lbENhc2VcclxuXHRcdFx0XHRcdFx0cHJvcE5hbWUgPSBhdHRyTmFtZS5zdWJzdHIoNSkucmVwbGFjZSgvLS4vZywgdG9VcHBlckNhc2UpO1xyXG5cdFx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShIVE1MNV9ET01TdHJpbmdNYXAsIHByb3BOYW1lLCB7XHJcblx0XHRcdFx0XHRcdFx0XHRlbnVtZXJhYmxlOiB0aGlzLmVudW1lcmFibGUsXHJcblx0XHRcdFx0XHRcdFx0XHRnZXQ6IGdldHRlci5iaW5kKGF0dHJWYWwgfHwgJycpLFxyXG5cdFx0XHRcdFx0XHRcdFx0c2V0OiBzZXR0ZXIuYmluZCh0aGF0LCBhdHRyTmFtZSlcclxuXHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRjYXRjaCAoZTIpIHsgLy8gaWYgYWNjZXNzb3JzIGFyZSBub3Qgd29ya2luZ1xyXG5cdFx0XHRcdFx0XHRcdEhUTUw1X0RPTVN0cmluZ01hcFtwcm9wTmFtZV0gPSBhdHRyVmFsO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybiBIVE1MNV9ET01TdHJpbmdNYXA7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHR0cnkge1xyXG5cdFx0XHQvLyBGRiBlbnVtZXJhdGVzIG92ZXIgZWxlbWVudCdzIGRhdGFzZXQsIGJ1dCBub3RcclxuXHRcdFx0Ly8gICBFbGVtZW50LnByb3RvdHlwZS5kYXRhc2V0OyBJRTkgaXRlcmF0ZXMgb3ZlciBib3RoXHJcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFbGVtZW50LnByb3RvdHlwZSwgJ2RhdGFzZXQnLCBwcm9wRGVzY3JpcHRvcik7XHJcblx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdHByb3BEZXNjcmlwdG9yLmVudW1lcmFibGUgPSBmYWxzZTsgLy8gSUU4IGRvZXMgbm90IGFsbG93IHNldHRpbmcgdG8gdHJ1ZVxyXG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoRWxlbWVudC5wcm90b3R5cGUsICdkYXRhc2V0JywgcHJvcERlc2NyaXB0b3IpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Ly8gUmV0dXJuIHRydWUgaWYgYW55IGFuY2VzdG9yIG1hdGNoZXMgc2VsZWN0b3JcclxuXHQvLyBCb3Jyb3dlZCBmcm9tIGFuY2VzdG9yTWF0Y2hlcygpIGZyb20gYWdhdmUuanMgKE1JVClcclxuXHR2YXIgaXNBbmNlc3Rvck9mID0gZnVuY3Rpb24oZWxlbWVudCwgc2VsZWN0b3IsIGluY2x1ZGVTZWxmKSB7XHJcblx0XHR2YXIgcGFyZW50ID0gZWxlbWVudC5wYXJlbnROb2RlO1xyXG5cdFx0aWYgKCBpbmNsdWRlU2VsZiAmJiBlbGVtZW50Lm1hdGNoZXMoc2VsZWN0b3IpICkge1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZVxyXG5cdFx0fVxyXG5cdFx0Ly8gV2hpbGUgcGFyZW50cyBhcmUgJ2VsZW1lbnQnIHR5cGUgbm9kZXNcclxuXHRcdC8vIFNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL0RPTS9Ob2RlLm5vZGVUeXBlXHJcblx0XHR3aGlsZSAoIHBhcmVudCAmJiBwYXJlbnQubm9kZVR5cGUgJiYgcGFyZW50Lm5vZGVUeXBlID09PSAxICkge1xyXG5cdFx0XHRpZiAoIHBhcmVudC5tYXRjaGVzKHNlbGVjdG9yKSApIHtcclxuXHRcdFx0XHRyZXR1cm4gdHJ1ZVxyXG5cdFx0XHR9XHJcblx0XHRcdHBhcmVudCA9IHBhcmVudC5wYXJlbnROb2RlO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH07XHJcblxyXG5cclxuXHQvLyBVc2VkIHRvIG1hdGNoIHNlbGVjdCBib3hlcyB0byB0aGVpciBzdHlsZSBzZWxlY3QgcGFydG5lcnNcclxuXHR2YXIgbWFrZVVVSUQgPSBmdW5jdGlvbigpe1xyXG5cdFx0cmV0dXJuICdzcy14eHh4LXh4eHgteHh4eC14eHh4LXh4eHgnLnJlcGxhY2UoL3gvZywgZnVuY3Rpb24gKGMpIHtcclxuXHRcdFx0dmFyIHIgPSBNYXRoLnJhbmRvbSgpICogMTYgfCAwLCB2ID0gYyA9PSAneCcgPyByIDogciAmIDB4MyB8IDB4ODtcclxuXHRcdFx0cmV0dXJuIHYudG9TdHJpbmcoMTYpO1xyXG5cdFx0fSlcclxuXHR9O1xyXG5cclxuXHJcblx0Ly8gVGhlICdzdHlsZVNlbGVjdCcgbWFpbiBmdW5jdGlvblxyXG5cdC8vIHNlbGVjdG9yOlN0cmluZyAtIENTUyBzZWxlY3RvciBmb3IgdGhlIHNlbGVjdCBib3ggdG8gc3R5bGVcclxuXHRyZXR1cm4gZnVuY3Rpb24oc2VsZWN0b3IpIHtcclxuXHJcblx0XHQvLyBVc2UgbmF0aXZlIHNlbGVjdHMgKHdoaWNoIHBvcCB1cCBsYXJnZSBuYXRpdmUgVUlzIHRvIGdvIHRocm91Z2ggdGhlIG9wdGlvbnMgKSBvbiBpT1MvQW5kcm9pZFxyXG5cdFx0aWYgKCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKCAvaVBhZHxpUGhvbmV8QW5kcm9pZC9pICkgKSB7XHJcblx0XHRcdHJldHVyblxyXG5cdFx0fVxyXG5cclxuXHRcdHZhciByZWFsU2VsZWN0ID0gcXVlcnkoc2VsZWN0b3IpLFxyXG5cdFx0XHRyZWFsT3B0aW9ucyA9IHJlYWxTZWxlY3QuY2hpbGRyZW4sXHJcblx0XHRcdHNlbGVjdGVkSW5kZXggPSByZWFsU2VsZWN0LnNlbGVjdGVkSW5kZXgsXHJcblx0XHRcdHV1aWQgPSBtYWtlVVVJRCgpLFxyXG5cdFx0XHRzdHlsZVNlbGVjdEhUTUwgPSAnPGRpdiBjbGFzcz1cInN0eWxlLXNlbGVjdFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiIGRhdGEtc3MtdXVpZD1cIicgKyB1dWlkICsgJ1wiPic7XHJcblxyXG5cdFx0Ly8gVGhlIGluZGV4IG9mIHRoZSBpdGVtIHRoYXQncyBiZWluZyBoaWdobGlnaHRlZCBieSB0aGUgbW91c2Ugb3Iga2V5Ym9hcmRcclxuXHRcdHZhciBoaWdobGlnaHRlZE9wdGlvbkluZGV4O1xyXG5cdFx0dmFyIGhpZ2hsaWdodGVkT3B0aW9uSW5kZXhNYXggPSByZWFsT3B0aW9ucy5sZW5ndGggLSAxO1xyXG5cclxuXHRcdHJlYWxTZWxlY3Quc2V0QXR0cmlidXRlKCdkYXRhLXNzLXV1aWQnLCB1dWlkKTtcclxuXHRcdC8vIEV2ZW4gdGhvdWdoIHRoZSBlbGVtZW50IGlzIGRpc3BsYXk6IG5vbmUsIGExMXkgdXNlcnMgc2hvdWxkIHN0aWxsIHNlZSBpdC5cclxuXHRcdC8vIEFjY29yZGluZyB0byBodHRwOi8vd3d3LnczLm9yZy9UUi93YWktYXJpYS9zdGF0ZXNfYW5kX3Byb3BlcnRpZXMjYXJpYS1oaWRkZW5cclxuXHRcdC8vIHNvbWUgYnJvd3NlcnMgbWF5IGhhdmUgYnVncyB3aXRoIHRoaXMgYnV0IGZ1dHVyZSBpbXBsZW1lbnRhdGlvbiBtYXkgaW1wcm92ZVxyXG5cdFx0cmVhbFNlbGVjdC5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgXCJmYWxzZVwiKTtcclxuXHJcblx0XHQvLyBCdWlsZCBzdHlsZWQgY2xvbmVzIG9mIGFsbCB0aGUgcmVhbCBvcHRpb25zXHJcblx0XHR2YXIgc2VsZWN0ZWRPcHRpb25IVE1MO1xyXG5cdFx0dmFyIG9wdGlvbnNIVE1MID0gJzxkaXYgY2xhc3M9XCJzcy1kcm9wZG93blwiPic7XHJcblx0XHRyZWFsT3B0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKHJlYWxPcHRpb24sIGluZGV4KXtcclxuXHRcdFx0dmFyIHRleHQgPSByZWFsT3B0aW9uLnRleHRDb250ZW50LFxyXG5cdFx0XHRcdHZhbHVlID0gcmVhbE9wdGlvbi5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykgfHwgJycsXHJcbiAgICAgICAgICAgICAgICBjc3NDbGFzcyA9ICdzcy1vcHRpb24nO1xyXG5cclxuXHRcdFx0aWYgKGluZGV4ID09PSBzZWxlY3RlZEluZGV4KSB7XHJcblx0XHRcdFx0Ly8gTWFyayBmaXJzdCBpdGVtIGFzIHNlbGVjdGVkLW9wdGlvbiAtIHRoaXMgaXMgd2hlcmUgd2Ugc3RvcmUgc3RhdGUgZm9yIHRoZSBzdHlsZWQgc2VsZWN0IGJveFxyXG5cdFx0XHRcdC8vIGFyaWEtaGlkZGVuPXRydWUgc28gc2NyZWVuIHJlYWRlcnMgaWdub3JlIHRoZSBzdHlsZXMgc2VsZXh0IGJveCBpbiBmYXZvciBvZiB0aGUgcmVhbCBvbmUgKHdoaWNoIGlzIHZpc2libGUgYnkgZGVmYXVsdClcclxuXHRcdFx0XHRzZWxlY3RlZE9wdGlvbkhUTUwgPSAnPGRpdiBjbGFzcz1cInNzLXNlbGVjdGVkLW9wdGlvblwiIHRhYmluZGV4PVwiMFwiIGRhdGEtdmFsdWU9XCInICsgdmFsdWUgKyAnXCI+JyArIHRleHQgKyAnPC9kaXY+J1xyXG5cdFx0XHR9XHJcblxyXG4gICAgICAgICAgICBpZiAocmVhbE9wdGlvbi5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgY3NzQ2xhc3MgKz0gJyBkaXNhYmxlZCc7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIENvbnRpbnVlIGJ1aWxkaW5nIG9wdGlvbnNIVE1MXHJcblx0XHRcdG9wdGlvbnNIVE1MICs9ICc8ZGl2IGNsYXNzPVwiJyArIGNzc0NsYXNzICsgJ1wiIGRhdGEtdmFsdWU9XCInICsgdmFsdWUgKyAnXCI+JyArIHRleHQgKyAnPC9kaXY+JztcclxuXHRcdH0pO1xyXG5cdFx0b3B0aW9uc0hUTUwgKz0gJzwvZGl2Pic7XHJcblx0XHRzdHlsZVNlbGVjdEhUTUwgKz0gc2VsZWN0ZWRPcHRpb25IVE1MICs9IG9wdGlvbnNIVE1MICs9ICc8L2Rpdj4nO1xyXG5cdFx0Ly8gQW5kIGFkZCBvdXQgc3R5bGVkIHNlbGVjdCBqdXN0IGFmdGVyIHRoZSByZWFsIHNlbGVjdFxyXG5cdFx0cmVhbFNlbGVjdC5pbnNlcnRBZGphY2VudEhUTUwoJ2FmdGVyZW5kJywgc3R5bGVTZWxlY3RIVE1MKTtcclxuXHJcblx0XHR2YXIgc3R5bGVkU2VsZWN0ID0gcXVlcnkoJy5zdHlsZS1zZWxlY3RbZGF0YS1zcy11dWlkPVwiJyt1dWlkKydcIl0nKTtcclxuXHRcdHZhciBzdHlsZVNlbGVjdE9wdGlvbnMgPSBzdHlsZWRTZWxlY3QucXVlcnlTZWxlY3RvckFsbCgnLnNzLW9wdGlvbicpO1xyXG5cdFx0dmFyIHNlbGVjdGVkT3B0aW9uID0gc3R5bGVkU2VsZWN0LnF1ZXJ5U2VsZWN0b3IoJy5zcy1zZWxlY3RlZC1vcHRpb24nKTtcclxuXHJcblx0XHR2YXIgY2hhbmdlUmVhbFNlbGVjdEJveCA9IGZ1bmN0aW9uKG5ld1ZhbHVlLCBuZXdMYWJlbCkge1xyXG5cdFx0XHQvLyBDbG9zZSBzdHlsZWRTZWxlY3RcclxuXHRcdFx0c3R5bGVkU2VsZWN0LmNsYXNzTGlzdC5yZW1vdmUoJ29wZW4nKTtcclxuXHJcblx0XHRcdC8vIFVwZGF0ZSBzdHlsZWQgdmFsdWVcclxuXHRcdFx0c2VsZWN0ZWRPcHRpb24udGV4dENvbnRlbnQgPSBuZXdMYWJlbDtcclxuXHRcdFx0c2VsZWN0ZWRPcHRpb24uZGF0YXNldC52YWx1ZSA9IG5ld1ZhbHVlO1xyXG5cclxuXHRcdFx0Ly8gVXBkYXRlIHRoZSAndGljaycgdGhhdCBzaG93cyB0aGUgb3B0aW9uIHdpdGggdGhlIGN1cnJlbnQgdmFsdWVcclxuXHRcdFx0c3R5bGVTZWxlY3RPcHRpb25zLmZvckVhY2goZnVuY3Rpb24oc3R5bGVTZWxlY3RPcHRpb24pe1xyXG5cdFx0XHRcdGlmICggc3R5bGVTZWxlY3RPcHRpb24uZGF0YXNldC52YWx1ZSA9PT0gbmV3VmFsdWUpIHtcclxuXHRcdFx0XHRcdHN0eWxlU2VsZWN0T3B0aW9uLmNsYXNzTGlzdC5hZGQoJ3RpY2tlZCcpXHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHN0eWxlU2VsZWN0T3B0aW9uLmNsYXNzTGlzdC5yZW1vdmUoJ3RpY2tlZCcpXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIFVwZGF0ZSByZWFsIHNlbGVjdCBib3hcclxuXHRcdFx0cmVhbFNlbGVjdC52YWx1ZSA9IG5ld1ZhbHVlO1xyXG5cclxuXHRcdFx0Ly8gU2VuZCAnY2hhbmdlJyBldmVudCB0byByZWFsIHNlbGVjdCAtIHRvIHRyaWdnZXIgYW55IGNoYW5nZSBldmVudCBsaXN0ZW5lcnNcclxuXHRcdFx0dmFyIGNoYW5nZUV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdjaGFuZ2UnKTtcclxuXHRcdFx0cmVhbFNlbGVjdC5kaXNwYXRjaEV2ZW50KGNoYW5nZUV2ZW50KTtcclxuXHRcdH07XHJcblxyXG5cdFx0Ly8gQ2hhbmdlIHJlYWwgc2VsZWN0IGJveCB3aGVuIGEgc3R5bGVkIG9wdGlvbiBpcyBjbGlja2VkXHJcblx0XHRzdHlsZVNlbGVjdE9wdGlvbnMuZm9yRWFjaChmdW5jdGlvbih1bnVzZWQsIGluZGV4KXtcclxuXHRcdFx0dmFyIHN0eWxlU2VsZWN0T3B0aW9uID0gc3R5bGVTZWxlY3RPcHRpb25zLml0ZW0oaW5kZXgpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHN0eWxlU2VsZWN0T3B0aW9uLmNsYXNzTmFtZS5tYXRjaCgvXFxiZGlzYWJsZWRcXGIvKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdHlsZVNlbGVjdE9wdGlvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2KSB7XHJcblx0XHRcdFx0dmFyIHRhcmdldCA9IGV2LnRhcmdldCxcclxuXHRcdFx0XHRcdHN0eWxlZFNlbGVjdEJveCA9IHRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUsXHJcblx0XHRcdFx0XHR1dWlkID0gc3R5bGVkU2VsZWN0Qm94LmdldEF0dHJpYnV0ZSgnZGF0YS1zcy11dWlkJyksXHJcblx0XHRcdFx0XHRuZXdWYWx1ZSA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsdWUnKSxcclxuXHRcdFx0XHRcdG5ld0xhYmVsID0gdGFyZ2V0LnRleHRDb250ZW50O1xyXG5cclxuXHRcdFx0XHRjaGFuZ2VSZWFsU2VsZWN0Qm94KG5ld1ZhbHVlLCBuZXdMYWJlbClcclxuXHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gVGljayBhbmQgaGlnaGxpZ2h0IHRoZSBvcHRpb24gdGhhdCdzIGN1cnJlbnRseSBpbiB1c2VcclxuXHRcdFx0aWYgKCBzdHlsZVNlbGVjdE9wdGlvbi5kYXRhc2V0LnZhbHVlID09PSByZWFsU2VsZWN0LnZhbHVlICkge1xyXG5cdFx0XHRcdGhpZ2hsaWdodGVkT3B0aW9uSW5kZXggPSBpbmRleDtcclxuXHRcdFx0XHRzdHlsZVNlbGVjdE9wdGlvbi5jbGFzc0xpc3QuYWRkKCd0aWNrZWQnKTtcclxuXHRcdFx0XHRzdHlsZVNlbGVjdE9wdGlvbi5jbGFzc0xpc3QuYWRkKCdoaWdobGlnaHRlZCcpXHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIEltcG9ydGFudDogd2UgY2FuJ3QgdXNlICc6aG92ZXInIGFzIHRoZSBrZXlib2FyZCBhbmQgZGVmYXVsdCB2YWx1ZSBjYW4gYWxzbyBzZXQgdGhlIGhpZ2hsaWdodFxyXG5cdFx0XHRzdHlsZVNlbGVjdE9wdGlvbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCBmdW5jdGlvbihldil7XHJcblx0XHRcdFx0c3R5bGVTZWxlY3RPcHRpb24ucGFyZW50Tm9kZS5jaGlsZE5vZGVzLmZvckVhY2goZnVuY3Rpb24oc2libGluZywgaW5kZXgpe1xyXG5cdFx0XHRcdFx0aWYgKCBzaWJsaW5nID09PSBldi50YXJnZXQgKSB7XHJcblx0XHRcdFx0XHRcdHNpYmxpbmcuY2xhc3NMaXN0LmFkZCgnaGlnaGxpZ2h0ZWQnKTtcclxuXHRcdFx0XHRcdFx0aGlnaGxpZ2h0ZWRPcHRpb25JbmRleCA9IGluZGV4O1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0c2libGluZy5jbGFzc0xpc3QucmVtb3ZlKCdoaWdobGlnaHRlZCcpXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSlcclxuXHRcdFx0fSlcclxuXHRcdH0pO1xyXG5cclxuXHJcblxyXG5cdFx0dmFyIGNsb3NlQWxsU3R5bGVTZWxlY3RzID0gZnVuY3Rpb24oZXhjZXB0aW9uKXtcclxuXHRcdFx0cXVlcnlBbGwoJy5zdHlsZS1zZWxlY3QnKS5mb3JFYWNoKGZ1bmN0aW9uKHN0eWxlU2VsZWN0RWwpIHtcclxuXHRcdFx0XHRpZiAoIHN0eWxlU2VsZWN0RWwgIT09IGV4Y2VwdGlvbiApIHtcclxuXHRcdFx0XHRcdHN0eWxlU2VsZWN0RWwuY2xhc3NMaXN0LnJlbW92ZSgnb3BlbicpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cclxuXHRcdHZhciB0b2dnbGVTdHlsZWRTZWxlY3QgPSBmdW5jdGlvbihzdHlsZWRTZWxlY3RCb3gpe1xyXG5cdFx0XHRpZiAoICEgc3R5bGVkU2VsZWN0Qm94LmNsYXNzTGlzdC5jb250YWlucygnb3BlbicpICkge1xyXG5cdFx0XHRcdC8vIElmIHdlJ3JlIGNsb3NlZCBhbmQgYWJvdXQgdG8gb3BlbiwgY2xvc2Ugb3RoZXIgc3R5bGUgc2VsZWN0cyBvbiB0aGUgcGFnZVxyXG5cdFx0XHRcdGNsb3NlQWxsU3R5bGVTZWxlY3RzKHN0eWxlZFNlbGVjdEJveCk7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gVGhlbiB0b2dnbGUgb3Blbi9jbG9zZVxyXG5cdFx0XHRzdHlsZWRTZWxlY3RCb3guY2xhc3NMaXN0LnRvZ2dsZSgnb3BlbicpO1xyXG5cdFx0fTtcclxuXHJcblx0XHQvLyBXaGVuIGEgc3R5bGVkIHNlbGVjdCBib3ggaXMgY2xpY2tlZFxyXG5cdFx0dmFyIHN0eWxlZFNlbGVjdGVkT3B0aW9uID0gcXVlcnkoJy5zdHlsZS1zZWxlY3RbZGF0YS1zcy11dWlkPVwiJyArIHV1aWQgKyAnXCJdIC5zcy1zZWxlY3RlZC1vcHRpb24nKTtcclxuXHRcdHN0eWxlZFNlbGVjdGVkT3B0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXYpIHtcclxuXHRcdFx0ZXYucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0ZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblx0XHRcdHRvZ2dsZVN0eWxlZFNlbGVjdChldi50YXJnZXQucGFyZW50Tm9kZSk7XHJcblx0XHR9KTtcclxuXHJcblx0XHQvLyBLZXlib2FyZCBoYW5kbGluZ1xyXG5cdFx0c3R5bGVkU2VsZWN0ZWRPcHRpb24uYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uKGV2KSB7XHJcblx0XHRcdHZhciBzdHlsZWRTZWxlY3RCb3ggPSBldi50YXJnZXQucGFyZW50Tm9kZTtcclxuXHJcblx0XHRcdHN3aXRjaCAoZXYua2V5Q29kZSkge1xyXG5cdFx0XHRcdGNhc2UgS0VZQ09ERVMuU1BBQ0U6XHJcblx0XHRcdFx0XHQvLyBTcGFjZSBzaG93cyBhbmQgaGlkZXMgc3R5bGVzIHNlbGVjdCBib3hlc1xyXG5cdFx0XHRcdFx0dG9nZ2xlU3R5bGVkU2VsZWN0KHN0eWxlZFNlbGVjdEJveCk7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlIEtFWUNPREVTLkRPV046XHJcblx0XHRcdFx0Y2FzZSBLRVlDT0RFUy5VUDpcclxuXHRcdFx0XHRcdC8vIE1vdmUgdGhlIGhpZ2hsaWdodCB1cCBhbmQgZG93blxyXG5cdFx0XHRcdFx0aWYgKCAhIHN0eWxlZFNlbGVjdEJveC5jbGFzc0xpc3QuY29udGFpbnMoJ29wZW4nKSApIHtcclxuXHRcdFx0XHRcdFx0Ly8gSWYgc3R5bGUgc2VsZWN0IGlzIG5vdCBvcGVuLCB1cC9kb3duIHNob3VsZCBvcGVuIGl0LlxyXG5cdFx0XHRcdFx0XHR0b2dnbGVTdHlsZWRTZWxlY3Qoc3R5bGVkU2VsZWN0Qm94KTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdC8vIElmIHN0eWxlIHNlbGVjdCBpcyBhbHJlYWR5IG9wZW4sIHRoZXNlIHNob3VsZCBjaGFuZ2Ugd2hhdCB0aGUgaGlnaGxpZ2h0ZWQgb3B0aW9uIGlzXHJcblx0XHRcdFx0XHRcdGlmICggZXYua2V5Q29kZSA9PT0gS0VZQ09ERVMuVVAgKSB7XHJcblx0XHRcdFx0XHRcdFx0Ly8gVXAgYXJyb3cgbW92ZXMgZWFybGllciBpbiBsaXN0XHJcblx0XHRcdFx0XHRcdFx0aWYgKCBoaWdobGlnaHRlZE9wdGlvbkluZGV4ICE9PSAwICkge1xyXG5cdFx0XHRcdFx0XHRcdFx0aGlnaGxpZ2h0ZWRPcHRpb25JbmRleCA9IGhpZ2hsaWdodGVkT3B0aW9uSW5kZXggLSAxXHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdC8vIERvd24gYXJyb3cgbW92ZXMgbGF0ZXIgaW4gbGlzdFxyXG5cdFx0XHRcdFx0XHRcdGlmICggaGlnaGxpZ2h0ZWRPcHRpb25JbmRleCA8IGhpZ2hsaWdodGVkT3B0aW9uSW5kZXhNYXggKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRoaWdobGlnaHRlZE9wdGlvbkluZGV4ID0gaGlnaGxpZ2h0ZWRPcHRpb25JbmRleCArIDFcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0c3R5bGVTZWxlY3RPcHRpb25zLmZvckVhY2goZnVuY3Rpb24ob3B0aW9uLCBpbmRleCl7XHJcblx0XHRcdFx0XHRcdFx0aWYgKCBpbmRleCA9PT0gaGlnaGxpZ2h0ZWRPcHRpb25JbmRleCApIHtcclxuXHRcdFx0XHRcdFx0XHRcdG9wdGlvbi5jbGFzc0xpc3QuYWRkKCdoaWdobGlnaHRlZCcpXHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdG9wdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdoaWdobGlnaHRlZCcpXHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0ZXYucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0XHRcdGV2LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Ly8gVXNlciBoYXMgcGlja2VkIGFuIGl0ZW0gZnJvbSB0aGUga2V5Ym9hcmRcclxuXHRcdFx0XHRjYXNlIEtFWUNPREVTLkVOVEVSOlxyXG5cdFx0XHRcdFx0dmFyIGhpZ2hsaWdodGVkT3B0aW9uID0gc3R5bGVkU2VsZWN0ZWRPcHRpb24ucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yQWxsKCcuc3Mtb3B0aW9uJylbaGlnaGxpZ2h0ZWRPcHRpb25JbmRleF0sXHJcblx0XHRcdFx0XHRcdG5ld1ZhbHVlID0gaGlnaGxpZ2h0ZWRPcHRpb24uZGF0YXNldC52YWx1ZSxcclxuXHRcdFx0XHRcdFx0bmV3TGFiZWwgPSBoaWdobGlnaHRlZE9wdGlvbi50ZXh0Q29udGVudDtcclxuXHJcblx0XHRcdFx0XHRjaGFuZ2VSZWFsU2VsZWN0Qm94KG5ld1ZhbHVlLCBuZXdMYWJlbCk7XHJcblx0XHRcdFx0XHRldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRcdFx0ZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gQ2xpY2tpbmcgb3V0c2lkZSBvZiB0aGUgc3R5bGVkIHNlbGVjdCBib3ggY2xvc2VzIGFueSBvcGVuIHN0eWxlZCBzZWxlY3QgYm94ZXNcclxuXHRcdHF1ZXJ5KCdib2R5JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldil7XHJcblxyXG5cdFx0XHRpZiAoICEgaXNBbmNlc3Rvck9mKGV2LnRhcmdldCwgJy5zdHlsZS1zZWxlY3QnLCB0cnVlKSApIHtcclxuXHRcdFx0XHRjbG9zZUFsbFN0eWxlU2VsZWN0cygpO1xyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cclxuXHR9O1xyXG5cclxuLy8gQ2xvc2UgVU1EIG1vZHVsZVxyXG59KSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
